(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1009:(e,t,a)=>{"use strict";a.d(t,{y:()=>r});var n=a(3915),s=a(5317);let r=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyBWqeEO_-9OWKKX_MIolTwnvPS0F5j4ANY",authDomain:"studynovabot.firebaseapp.com",projectId:"studynovabot",storageBucket:"studynovabot.firebasestorage.app",messagingSenderId:"250481817155",appId:"1:250481817155:web:160f30bdb36bbc375dc6f6"});(0,s.aU)(r)},2380:(e,t,a)=>{Promise.resolve().then(a.bind(a,9231))},8007:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(5155),s=a(2115),r=a(5695),i=a(3004),o=a(1009);function c(){let[e,t]=(0,s.useState)(""),[a,c]=(0,s.useState)(""),[l,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),h=(0,r.useRouter)(),g=(0,i.xI)(o.y),p=async t=>{t.preventDefault(),m("");try{l?await (0,i.eJ)(g,e,a):await (0,i.x9)(g,e,a),h.push("/")}catch(e){m(e.message)}},f=async()=>{m("");try{let e=new i.HF;await (0,i.df)(g,e),h.push("/")}catch(e){m(e.message)}};return(0,n.jsxs)("div",{style:{maxWidth:400,margin:"4rem auto",padding:24,background:"#222",borderRadius:12},children:[(0,n.jsx)("h2",{children:l?"Register":"Login"}),(0,n.jsxs)("form",{onSubmit:p,style:{display:"flex",flexDirection:"column",gap:12},children:[(0,n.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,n.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>c(e.target.value),required:!0}),(0,n.jsx)("button",{type:"submit",children:l?"Register":"Login"})]}),(0,n.jsxs)("button",{onClick:f,style:{marginTop:12,background:"#fff",color:"#222",border:"1px solid #ccc",borderRadius:4,padding:8,cursor:"pointer",fontWeight:500},children:[(0,n.jsx)("span",{style:{marginRight:8,fontSize:20},children:"\uD83D\uDD35"})," Sign in with Google"]}),(0,n.jsx)("button",{onClick:()=>d(e=>!e),style:{marginTop:8,background:"none",color:"#1cc592",border:"none",cursor:"pointer"},children:l?"Already have an account? Login":"No account? Register"}),u&&(0,n.jsx)("div",{style:{color:"red",marginTop:8},children:u})]})}},9231:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var n=a(5155),s=a(2115),r=a(3004),i=a(1009),o=a(5695),c=a(8007),l=a(6766);function d(e){let{message:t,animate:a}=e,[r,i]=s.useState([]),o=s.useMemo(()=>(function(e){let t=e.split(/\r?\n/).filter(e=>""!==e.trim()),a=[];for(let e of t){let t=e.match(/!\[.*?]\((.*?)\)/)||e.match(/(https?:\/\/\S+\.(jpg|jpeg|png|gif))/);if(t){a.push({type:"image",url:t[1]||t[0]});continue}/^\d+[.)]/.test(e)?a.push({type:"text",content:"\uD83D\uDD22 ".concat(e.replace(/^\d+[.)]\s*/,""))}):/^[-*•]/.test(e)?a.push({type:"text",content:"\uD83D\uDC49 ".concat(e.replace(/^[-*•]\s*/,""))}):a.push({type:"text",content:"\uD83E\uDD16 ".concat(e)})}return a})(t),[t]);return(0,s.useEffect)(()=>{if(!a)return void i(o.map(e=>"text"===e.type?e.content:{type:"image",url:e.url}));i([]);let e=0;!function t(){if(e>=o.length)return;let a=o[e];i(e=>[...e,"text"===a.type?a.content:{type:"image",url:a.url}]),e++,setTimeout(t,400)}()},[o,a]),(0,n.jsx)("div",{children:r.map((e,t)=>"string"==typeof e?(0,n.jsx)("div",{style:{whiteSpace:"pre-line",marginBottom:4},children:e},t):"string"==typeof e.url&&e.url.startsWith("data:image/")?(0,n.jsx)("div",{className:"relative w-full aspect-square",children:(0,n.jsx)(l.default,{src:e.url.replace("data:image/png;base64,",""),alt:"Generated visual",fill:!0,className:"rounded-lg object-contain",unoptimized:!0})},t):(0,n.jsx)("div",{style:{color:"red",marginBottom:4},children:"[Image generation failed or invalid image]"},t))})}function u(e){let{user:t}=e,[a,r]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),[c,l]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[h,g]=(0,s.useState)(!1),[p,f]=(0,s.useState)("all"),[b,y]=(0,s.useState)([{id:"all",name:"All chats",icon:"\uD83D\uDCC1",chats:[]},{id:"study",name:"Study",icon:"\uD83D\uDCDA",chats:[]},{id:"code",name:"Code",icon:"\uD83D\uDCBB",chats:[]}]),[x,j]=(0,s.useState)(null),[v,N]=(0,s.useState)(!1),S=(0,s.useRef)(null),w=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!a)return;let e=e=>{"Escape"===e.key&&r(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]),(0,s.useEffect)(()=>{a?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[a]),(0,s.useEffect)(()=>{S.current&&c.length>0&&S.current.scrollIntoView({behavior:"smooth"})},[c]);let D=e=>{var t;o(e),null==(t=w.current)||t.focus()},k=e=>{f(e);let t=b.find(t=>t.id===e);t&&t.chats.length>0?(l(t.chats[t.chats.length-1]),m(!1)):(l([]),m(!0))},C=async e=>{if(e&&e.preventDefault(),!i.trim())return;let t=[...c,{role:"user",content:i}];l(e=>[...e,{role:"user",content:i}]),o(""),m(!1),g(!0);let a=!v&&/(?:\bcreate\b|\brecreate\b|\bmake\b|\bgenerate\b|\bdraw\b|\bimage\b)/i.test(i),n=/(?:edit|change|fix|adjust|modify|improve|upgrade|should|more\s+cute|cute)/i.test(i),s=[...t];if(n&&x){N(!0);let e="".concat(x,", ").concat(i);try{let t=await fetch("/api/genImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:e})}),a=await t.json(),n=a.image?"![Generated Image](".concat(a.image,")"):a.error?"[Image generation failed: ".concat(a.error,"]"):"[Image generation failed]";a.image&&j(e),l(e=>[...e,{role:"assistant",content:n}])}catch(t){let e=t instanceof Error?t.message:JSON.stringify(t);l(t=>[...t,{role:"assistant",content:"[Image generation failed: ".concat(e,"]")}])}N(!1),g(!1);return}if(a){N(!0);try{let e=await fetch("/api/genImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:i})}),t=await e.json();(null==t?void 0:t.image)?(l(e=>[...e,{role:"assistant",content:"![Generated Image](".concat(t.image,")")}]),j(i)):(null==t?void 0:t.error)?l(e=>[...e,{role:"assistant",content:"[Image generation failed: ".concat(t.error,"]")}]):l(e=>[...e,{role:"assistant",content:"[Image generation failed or invalid image]"}])}catch(t){let e=t instanceof Error?t.message:JSON.stringify(t);l(t=>[...t,{role:"assistant",content:"[Image generation failed: ".concat(e,"]")}])}N(!1),g(!1);return}let r=c.filter(e=>"user"===e.role||"assistant"===e.role).slice(-3).map(e=>({role:e.role,content:e.content.replace(/!\[.*?]\(.*?\)/g,"[image]")}));r.push({role:"user",content:i});try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:r})}),t=await e.json();if(!e.ok){let e="Unknown error occurred";t&&t.error?"string"==typeof t.error?e=t.error:"object"==typeof t.error&&(e=JSON.stringify(t.error)):"object"==typeof t&&(e=JSON.stringify(t)),l(t=>[...t,{role:"assistant",content:"Error: ".concat(e)}]),g(!1);return}let a=t.reply||"No response from AI.",n=[...s,{role:"assistant",content:a}];l(n),y(e=>e.map(e=>e.id===p||"all"===e.id&&"all"!==p?{...e,chats:[...e.chats,n]}:e)),g(!1)}catch(t){console.error("Error occurred:",t);let e=t instanceof Error&&t.message||"Unknown error occurred";l(t=>[...t,{role:"assistant",content:"Error: ".concat(e)}]),g(!1)}};return(0,n.jsxs)("div",{className:"chat-container",children:[(0,n.jsx)("button",{className:"hamburger","aria-label":a?"Close sidebar":"Open sidebar",onClick:()=>r(e=>!e),children:a?"✖":"☰"}),a&&(0,n.jsx)("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:999},onClick:()=>r(!1),"aria-label":"Close sidebar overlay"}),(0,n.jsxs)("aside",{className:"sidebar".concat(a?" open":""),children:[(0,n.jsx)("div",{className:"sidebar-header",children:(0,n.jsx)("h2",{children:"Study Nova"})}),(0,n.jsx)("div",{className:"folder-list",children:b.map(e=>(0,n.jsxs)("div",{className:"folder ".concat(p===e.id?"active":""),onClick:()=>k(e.id),children:[(0,n.jsx)("span",{className:"folder-icon",children:e.icon}),(0,n.jsx)("span",{className:"folder-name",children:e.name}),e.chats.length>0&&(0,n.jsx)("span",{className:"chat-count",children:e.chats.length})]},e.id))})]}),(0,n.jsxs)("div",{className:"main-content",children:[(0,n.jsx)("header",{className:"chat-header",children:(0,n.jsx)("h1",{className:"site-title",children:"Study Nova Bot"})}),(0,n.jsxs)("main",{className:"main-container",children:[(0,n.jsxs)("div",{className:"chat-interface".concat(u?" welcome-mode":""),children:[(0,n.jsxs)("div",{className:"messages-container",children:[u&&(0,n.jsx)("div",{className:"welcome-container",children:(0,n.jsx)("h1",{children:"What can I help with?"})}),c.map((e,t)=>(0,n.jsx)("div",{className:"message ".concat("user"===e.role?"user-message":"bot-message"),children:(0,n.jsx)("div",{className:"message-content",children:"assistant"===e.role?(0,n.jsx)(d,{message:e.content,animate:t===c.length-1&&h}):e.content})},t)),(0,n.jsx)("div",{ref:S})]}),(0,n.jsx)("form",{onSubmit:C,className:"input-container",children:(0,n.jsxs)("div",{className:"input-wrapper",children:[(0,n.jsx)("input",{type:"text",placeholder:"Send a message...",value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C())},className:"chat-input",disabled:h,ref:w}),(0,n.jsx)("button",{type:"submit",disabled:!i.trim()||h,className:"send-button",children:h?"...":"→"})]})})]}),(0,n.jsxs)("div",{className:"suggestions",children:[(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>D("Create an image of a beautiful sunset over mountains"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83C\uDFA8"})," Create image "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>D("Help me brainstorm ideas for a science fiction story"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83D\uDCA1"})," Brainstorm "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>D("Help me write a professional email to schedule a meeting"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"✍️"})," Help me write "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>D("Summarize this text: [paste your text here]"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83D\uDCDD"})," Summarize text "]})]})]})]})]})}function m(){let[e,t]=(0,s.useState)(!1),[a,l]=(0,s.useState)(null),d=(0,o.useRouter)();return((0,s.useEffect)(()=>{let e=(0,r.xI)(i.y);return(0,r.hg)(e,e=>{l(e||null),t(!0)})},[d]),e)?a?(0,n.jsx)(u,{user:a}):(0,n.jsx)(c.default,{}):(0,n.jsx)("div",{style:{textAlign:"center",marginTop:"4rem",color:"#fff"},children:"Checking authentication..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,765,306,766,441,684,358],()=>t(2380)),_N_E=e.O()}]);