(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1009:(e,t,a)=>{"use strict";a.d(t,{y:()=>r});var n=a(3915),s=a(5317);let r=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyBWqeEO_-9OWKKX_MIolTwnvPS0F5j4ANY",authDomain:"studynovabot.firebaseapp.com",projectId:"studynovabot",storageBucket:"studynovabot.firebasestorage.app",messagingSenderId:"250481817155",appId:"1:250481817155:web:160f30bdb36bbc375dc6f6"});(0,s.aU)(r)},2380:(e,t,a)=>{Promise.resolve().then(a.bind(a,9231))},8007:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(5155),s=a(2115),r=a(5695),i=a(3004),o=a(1009);function c(){let[e,t]=(0,s.useState)(""),[a,c]=(0,s.useState)(""),[l,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),h=(0,r.useRouter)(),g=(0,i.xI)(o.y),p=async t=>{t.preventDefault(),m("");try{l?await (0,i.eJ)(g,e,a):await (0,i.x9)(g,e,a),h.push("/")}catch(e){m(e.message)}},f=async()=>{m("");try{let e=new i.HF;await (0,i.df)(g,e),h.push("/")}catch(e){m(e.message)}};return(0,n.jsxs)("div",{style:{maxWidth:400,margin:"4rem auto",padding:24,background:"#222",borderRadius:12},children:[(0,n.jsx)("h2",{children:l?"Register":"Login"}),(0,n.jsxs)("form",{onSubmit:p,style:{display:"flex",flexDirection:"column",gap:12},children:[(0,n.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,n.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>c(e.target.value),required:!0}),(0,n.jsx)("button",{type:"submit",children:l?"Register":"Login"})]}),(0,n.jsxs)("button",{onClick:f,style:{marginTop:12,background:"#fff",color:"#222",border:"1px solid #ccc",borderRadius:4,padding:8,cursor:"pointer",fontWeight:500},children:[(0,n.jsx)("span",{style:{marginRight:8,fontSize:20},children:"\uD83D\uDD35"})," Sign in with Google"]}),(0,n.jsx)("button",{onClick:()=>d(e=>!e),style:{marginTop:8,background:"none",color:"#1cc592",border:"none",cursor:"pointer"},children:l?"Already have an account? Login":"No account? Register"}),u&&(0,n.jsx)("div",{style:{color:"red",marginTop:8},children:u})]})}},9231:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var n=a(5155),s=a(2115),r=a(3004),i=a(1009),o=a(5695),c=a(8007);function l(e){let{message:t,animate:a}=e,[r,i]=s.useState([]),o=s.useMemo(()=>(function(e){let t=e.split(/\r?\n/).filter(e=>""!==e.trim()),a=[];for(let e of t){let t=e.match(/!\[.*?]\((.*?)\)/)||e.match(/(https?:\/\/\S+\.(jpg|jpeg|png|gif))/);if(t){a.push({type:"image",url:t[1]||t[0]});continue}/^\d+[.)]/.test(e)?a.push({type:"text",content:"\uD83D\uDD22 ".concat(e.replace(/^\d+[.)]\s*/,""))}):/^[-*•]/.test(e)?a.push({type:"text",content:"\uD83D\uDC49 ".concat(e.replace(/^[-*•]\s*/,""))}):a.push({type:"text",content:"\uD83E\uDD16 ".concat(e)})}return a})(t),[t]);return(0,s.useEffect)(()=>{if(!a)return void i(o.map(e=>"text"===e.type?e.content:{type:"image",url:e.url}));i([]);let e=0;!function t(){if(e>=o.length)return;let a=o[e];i(e=>[...e,"text"===a.type?a.content:{type:"image",url:a.url}]),e++,setTimeout(t,400)}()},[o,a]),(0,n.jsx)("div",{children:r.map((e,t)=>"string"==typeof e?(0,n.jsx)("div",{style:{whiteSpace:"pre-line",marginBottom:4},children:e},t):"string"==typeof e.url&&e.url.startsWith("data:image/")?(0,n.jsx)("div",{style:{margin:"10px 0"},children:(0,n.jsx)("img",{src:e.url,alt:"Generated visual",style:{maxWidth:"100%",borderRadius:8}})},t):(0,n.jsx)("div",{style:{color:"red",marginBottom:4},children:"[Image generation failed or invalid image]"},t))})}function d(e){let{user:t}=e,[a,r]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[h,g]=(0,s.useState)(!1),[p,f]=(0,s.useState)("all"),[x,y]=(0,s.useState)([{id:"all",name:"All chats",icon:"\uD83D\uDCC1",chats:[]},{id:"study",name:"Study",icon:"\uD83D\uDCDA",chats:[]},{id:"code",name:"Code",icon:"\uD83D\uDCBB",chats:[]}]),v=(0,s.useRef)(null),j=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!a)return;let e=e=>{"Escape"===e.key&&r(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a]),(0,s.useEffect)(()=>{a?document.body.classList.add("sidebar-open"):document.body.classList.remove("sidebar-open")},[a]),(0,s.useEffect)(()=>{v.current&&c.length>0&&v.current.scrollIntoView({behavior:"smooth"})},[c]);let b=e=>{var t;o(e),null==(t=j.current)||t.focus()},N=e=>{f(e);let t=x.find(t=>t.id===e);t&&t.chats.length>0?(d(t.chats[t.chats.length-1]),m(!1)):(d([]),m(!0))},w=async e=>{if(e&&e.preventDefault(),!i.trim())return;let t=[...c.filter(e=>!e.content.includes("data:image/")),{role:"user",content:i}];d([...c,{role:"user",content:i}]),o(""),m(!1),g(!0);let a=/image|draw|picture|visual|photo|generate|create.*image|\[image\]/i.test(i),n=/more cute|improve|upgrade|make.*better|add|change|modify/i.test(i),s=[...t];if(n){let e=[...c].reverse().find(e=>"user"===e.role&&/image|draw|picture|visual|photo|generate|create.*image|\[image\]/i.test(e.content));if(e){let t="".concat(e.content,", ").concat(i);try{let e=await fetch("/api/genImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:t})}),a=await e.json();s=(null==a?void 0:a.image)?[...c,{role:"user",content:i},{role:"assistant",content:"![Generated Image](".concat(a.image,")")}]:(null==a?void 0:a.error)?[...c,{role:"user",content:i},{role:"assistant",content:"[Image generation failed: ".concat(a.error,"]")}]:[...c,{role:"user",content:i},{role:"assistant",content:"[Image generation failed or invalid image]"}],d(s)}catch(e){d(s=[...c,{role:"user",content:i},{role:"assistant",content:"[Image generation failed: ".concat(e,"]")}])}g(!1);return}}if(a){try{let e=await fetch("/api/genImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:i})}),t=await e.json();s=(null==t?void 0:t.image)?[...s,{role:"assistant",content:"![Generated Image](".concat(t.image,")")}]:(null==t?void 0:t.error)?[...s,{role:"assistant",content:"[Image generation failed: ".concat(t.error,"]")}]:[...s,{role:"assistant",content:"[Image generation failed or invalid image]"}],d(s)}catch(e){d(s=[...s,{role:"assistant",content:"[Image generation failed: ".concat(e,"]")}])}g(!1);return}try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t})}),a=await e.json();if(!e.ok){let e="string"==typeof a.error?a.error:JSON.stringify(a.error);throw Error(e||"Unknown error occurred")}let n=a.reply||"No response from AI.",r=[...s,{role:"assistant",content:n}];d(r),y(e=>e.map(e=>e.id===p||"all"===e.id&&"all"!==p?{...e,chats:[...e.chats,r]}:e)),g(!1)}catch(t){console.error("Error occurred:",t);let e=t instanceof Error&&t.message||"Unknown error occurred";d(t=>[...t,{role:"assistant",content:"Error: ".concat(e)}]),g(!1)}};return(0,n.jsxs)("div",{className:"chat-container",children:[(0,n.jsx)("button",{className:"hamburger","aria-label":a?"Close sidebar":"Open sidebar",onClick:()=>r(e=>!e),children:a?"✖":"☰"}),a&&(0,n.jsx)("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:999},onClick:()=>r(!1),"aria-label":"Close sidebar overlay"}),(0,n.jsxs)("aside",{className:"sidebar".concat(a?" open":""),children:[(0,n.jsx)("div",{className:"sidebar-header",children:(0,n.jsx)("h2",{children:"Study Nova"})}),(0,n.jsx)("div",{className:"folder-list",children:x.map(e=>(0,n.jsxs)("div",{className:"folder ".concat(p===e.id?"active":""),onClick:()=>N(e.id),children:[(0,n.jsx)("span",{className:"folder-icon",children:e.icon}),(0,n.jsx)("span",{className:"folder-name",children:e.name}),e.chats.length>0&&(0,n.jsx)("span",{className:"chat-count",children:e.chats.length})]},e.id))})]}),(0,n.jsxs)("div",{className:"main-content",children:[(0,n.jsx)("header",{className:"chat-header",children:(0,n.jsx)("h1",{className:"site-title",children:"Study Nova Bot"})}),(0,n.jsxs)("main",{className:"main-container",children:[(0,n.jsxs)("div",{className:"chat-interface".concat(u?" welcome-mode":""),children:[(0,n.jsxs)("div",{className:"messages-container",children:[u&&(0,n.jsx)("div",{className:"welcome-container",children:(0,n.jsx)("h1",{children:"What can I help with?"})}),c.map((e,t)=>(0,n.jsx)("div",{className:"message ".concat("user"===e.role?"user-message":"bot-message"),children:(0,n.jsx)("div",{className:"message-content",children:"assistant"===e.role?(0,n.jsx)(l,{message:e.content,animate:t===c.length-1&&h}):e.content})},t)),(0,n.jsx)("div",{ref:v})]}),(0,n.jsx)("form",{onSubmit:w,className:"input-container",children:(0,n.jsxs)("div",{className:"input-wrapper",children:[(0,n.jsx)("input",{type:"text",placeholder:"Send a message...",value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},className:"chat-input",disabled:h,ref:j}),(0,n.jsx)("button",{type:"submit",disabled:!i.trim()||h,className:"send-button",children:h?"...":"→"})]})})]}),(0,n.jsxs)("div",{className:"suggestions",children:[(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>b("Create an image of a beautiful sunset over mountains"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83C\uDFA8"})," Create image "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>b("Help me brainstorm ideas for a science fiction story"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83D\uDCA1"})," Brainstorm "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>b("Help me write a professional email to schedule a meeting"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"✍️"})," Help me write "]}),(0,n.jsxs)("button",{className:"suggestion-btn",onClick:()=>b("Summarize this text: [paste your text here]"),children:[" ",(0,n.jsx)("span",{className:"icon",children:"\uD83D\uDCDD"})," Summarize text "]})]})]})]})]})}function u(){let[e,t]=(0,s.useState)(!1),[a,l]=(0,s.useState)(null),u=(0,o.useRouter)();return((0,s.useEffect)(()=>{let e=(0,r.xI)(i.y);return(0,r.hg)(e,e=>{l(e||null),t(!0)})},[u]),e)?a?(0,n.jsx)(d,{user:a}):(0,n.jsx)(c.default,{}):(0,n.jsx)("div",{style:{textAlign:"center",marginTop:"4rem",color:"#fff"},children:"Checking authentication..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,765,306,441,684,358],()=>t(2380)),_N_E=e.O()}]);